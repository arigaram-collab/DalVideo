<Window x:Class="DalVideo.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:DalVideo.ViewModels"
        xmlns:props="clr-namespace:DalVideo.Properties"
        mc:Ignorable="d"
        Title="{x:Static props:Strings.WindowTitle}"
        SizeToContent="WidthAndHeight" MinWidth="500"
        ResizeMode="CanMinimize"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource WindowBg}"
        Foreground="{StaticResource FgBrush}">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </Window.Resources>
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 캡처 모드 선택 -->
        <GroupBox Grid.Row="0" Header="{x:Static props:Strings.CaptureTargetHeader}" Padding="8" Margin="0,0,0,6">
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{x:Static props:Strings.ModeLabel}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <ComboBox Width="200"
                              ItemsSource="{Binding CaptureModes}"
                              SelectedItem="{Binding SelectedCaptureMode}"
                              IsEnabled="{Binding IsIdle}"
                              TabIndex="0"
                              AutomationProperties.Name="{x:Static props:Strings.Access_CaptureMode}"
                              ToolTip="{x:Static props:Strings.Tooltip_CaptureMode}"/>
                    <Button Content="{x:Static props:Strings.ChangeTargetButton}" Margin="8,0,0,0"
                            Width="80"
                            Style="{StaticResource DarkButton}"
                            Command="{Binding ChangeCaptureTargetCommand}"
                            Visibility="{Binding IsRecording, Converter={StaticResource BoolToVis}}"
                            AutomationProperties.Name="{x:Static props:Strings.Access_ChangeTarget}"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                    <TextBlock Text="{x:Static props:Strings.WindowLabel}" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <ComboBox Width="300"
                              ItemsSource="{Binding AvailableWindows}"
                              SelectedItem="{Binding SelectedWindow}"
                              TabIndex="1"
                              AutomationProperties.Name="{x:Static props:Strings.Access_WindowSelect}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Title}"/>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <Button Content="{x:Static props:Strings.RefreshButton}" Margin="8,0,0,0"
                            Style="{StaticResource DarkButton}"
                            Command="{Binding RefreshWindowListCommand}"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <!-- 오디오 설정 -->
        <GroupBox Grid.Row="1" Header="{x:Static props:Strings.AudioHeader}" Padding="8" Margin="0,0,0,6">
            <StackPanel Orientation="Horizontal">
                <CheckBox Content="{x:Static props:Strings.SystemAudioLabel}"
                          IsChecked="{Binding CaptureSystemAudio}"
                          IsEnabled="{Binding IsIdle}"
                          Margin="0,0,20,0"
                          TabIndex="2"
                          AutomationProperties.Name="{x:Static props:Strings.Access_SystemAudio}"
                          ToolTip="{x:Static props:Strings.Tooltip_SystemAudio}"/>
                <CheckBox Content="{x:Static props:Strings.MicrophoneLabel}"
                          IsChecked="{Binding CaptureMicrophone}"
                          IsEnabled="{Binding IsIdle}"
                          TabIndex="3"
                          AutomationProperties.Name="{x:Static props:Strings.Access_Microphone}"
                          ToolTip="{x:Static props:Strings.Tooltip_Microphone}"/>
            </StackPanel>
        </GroupBox>

        <!-- 설정 -->
        <GroupBox Grid.Row="2" Header="{x:Static props:Strings.SettingsHeader}" Padding="8" Margin="0,0,0,6">
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{x:Static props:Strings.FpsLabel}" VerticalAlignment="Center" Margin="0,0,8,0" FontWeight="SemiBold"/>
                    <ComboBox Width="70"
                              ItemsSource="{Binding FrameRates}"
                              SelectedItem="{Binding FrameRate}"
                              IsEnabled="{Binding IsIdle}"
                              TabIndex="4"
                              AutomationProperties.Name="{x:Static props:Strings.Access_Fps}"
                              ToolTip="{x:Static props:Strings.Tooltip_Fps}"/>
                    <TextBlock Text="{x:Static props:Strings.QualityLabel}" VerticalAlignment="Center" Margin="16,0,8,0" FontWeight="SemiBold"/>
                    <ComboBox Width="80"
                              ItemsSource="{Binding QualityPresets}"
                              SelectedItem="{Binding SelectedQuality}"
                              IsEnabled="{Binding IsIdle}"
                              TabIndex="5"
                              AutomationProperties.Name="{x:Static props:Strings.Access_Quality}"
                              ToolTip="{x:Static props:Strings.Tooltip_Quality}"/>
                    <CheckBox Content="{x:Static props:Strings.CountdownLabel}"
                              IsChecked="{Binding UseCountdown}"
                              IsEnabled="{Binding IsIdle}"
                              Margin="16,0,0,0" VerticalAlignment="Center"
                              TabIndex="6"
                              AutomationProperties.Name="{x:Static props:Strings.Access_Countdown}"
                              ToolTip="{x:Static props:Strings.Tooltip_Countdown}"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                    <TextBlock Text="{x:Static props:Strings.EncoderLabel}" VerticalAlignment="Center" Margin="0,0,8,0" FontWeight="SemiBold"/>
                    <ComboBox Width="160"
                              ItemsSource="{Binding AvailableEncoders}"
                              SelectedValue="{Binding SelectedEncoder}"
                              SelectedValuePath="Id"
                              DisplayMemberPath="DisplayName"
                              IsEnabled="{Binding IsIdle}"
                              AutomationProperties.Name="{x:Static props:Strings.Access_Encoder}"
                              ToolTip="{x:Static props:Strings.Tooltip_Encoder}"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                    <TextBlock Text="{x:Static props:Strings.SaveLabel}" VerticalAlignment="Center" Margin="0,0,8,0" FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding OutputDirectory}" VerticalAlignment="Center"
                               MaxWidth="320" TextTrimming="CharacterEllipsis"
                               Foreground="{StaticResource FgDim}" FontSize="12"/>
                    <Button Content="{x:Static props:Strings.ChangeButton}" Margin="8,0,0,0"
                            Style="{StaticResource DarkButton}"
                            Command="{Binding ChangeOutputDirectoryCommand}"
                            IsEnabled="{Binding IsIdle}"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <!-- F8 안내 -->
        <TextBlock Grid.Row="3" Text="{x:Static props:Strings.HotkeyHint}"
                   HorizontalAlignment="Center" Margin="0,2,0,0"
                   Foreground="{StaticResource FgDim}" FontSize="11"/>

        <!-- 녹화 시간 -->
        <StackPanel Grid.Row="4" HorizontalAlignment="Center" Margin="0,6,0,6">
            <TextBlock Text="{Binding ElapsedTimeText}"
                       FontSize="44"
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       Foreground="{StaticResource TimerBrush}"
                       AutomationProperties.Name="{x:Static props:Strings.Access_ElapsedTime}"/>
            <TextBlock Text="{Binding StatusText}"
                       FontSize="12"
                       HorizontalAlignment="Center"
                       Foreground="{StaticResource FgDim}"
                       Margin="0,2,0,0"/>
        </StackPanel>

        <!-- 컨트롤 버튼 -->
        <StackPanel Grid.Row="5" Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Margin="0,4,0,8">
            <Button Content="{x:Static props:Strings.StartRecordingButton}"
                    Width="140" Height="44"
                    Margin="0,0,12,0"
                    Style="{StaticResource RecordButton}"
                    Command="{Binding StartRecordingCommand}"
                    TabIndex="7"
                    AutomationProperties.Name="{x:Static props:Strings.Access_StartRecording}"
                    ToolTip="{x:Static props:Strings.Tooltip_StartRecording}"/>
            <Button Content="{Binding PauseButtonText}"
                    Width="100" Height="44"
                    Margin="0,0,12,0"
                    Style="{StaticResource DarkButton}"
                    Command="{Binding TogglePauseCommand}"
                    TabIndex="8"
                    AutomationProperties.Name="{x:Static props:Strings.Access_PauseRecording}"
                    ToolTip="{x:Static props:Strings.Tooltip_PauseRecording}"/>
            <Button Content="{x:Static props:Strings.StopRecordingButton}"
                    Width="140" Height="44"
                    Style="{StaticResource StopButton}"
                    Command="{Binding StopRecordingCommand}"
                    TabIndex="9"
                    AutomationProperties.Name="{x:Static props:Strings.Access_StopRecording}"
                    ToolTip="{x:Static props:Strings.Tooltip_StopRecording}"/>
        </StackPanel>

        <!-- 상태 바 -->
        <Border Grid.Row="6" Margin="-16,4,-16,-16" Background="{StaticResource StatusBarBg}" Padding="12,8">
            <DockPanel>
                <Button Content="{x:Static props:Strings.OpenFolderButton}" DockPanel.Dock="Right"
                        Style="{StaticResource DarkButton}"
                        Command="{Binding OpenOutputFolderCommand}"
                        FontSize="11" Padding="10,3" Margin="8,0,0,0"/>
                <TextBlock Text="{Binding StatusText}" Foreground="{StaticResource FgDim}" FontSize="12"
                           VerticalAlignment="Center"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>
